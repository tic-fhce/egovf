"use strict";(self["webpackChunkegovf"]=self["webpackChunkegovf"]||[]).push([[67],{9067:function(e,t,r){r.r(t),r.d(t,{default:function(){return be}});var o=r(6768);const l=(0,o.Lk)("br",null,null,-1);function s(e,t,r,s,a,i){const n=(0,o.g2)("ComponenteDatosPersonalesVue"),u=(0,o.g2)("ComponenteReporteVue");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(n,{cifCiudadano:a.cifCiudadano,egovfp:a.egovf},null,8,["cifCiudadano","egovfp"]),l,(0,o.bF)(u,{reporte:a.reporte,uri:a.uri},null,8,["reporte","uri"])],64)}r(4114);var a=r(9790),i=r(4232);const n=e=>((0,o.Qi)("data-v-c666e7fe"),e=e(),(0,o.jt)(),e),u={class:"oculto"},c={class:"table table-striped table-hover",id:"printDatos"},h=n((()=>(0,o.Lk)("tr",null,[(0,o.Lk)("td",{colspan:"5",class:"text-center"},[(0,o.Lk)("h4",null,"Datos de Usuario Registrado en Biometricos")])],-1))),d={class:"table table-striped table-hover",id:"printHorario"},p=n((()=>(0,o.Lk)("tr",null,[(0,o.Lk)("td",{colspan:"4",class:"text-center"},[(0,o.Lk)("h4",null,"Horarios del Usuario")])],-1))),g={class:"table table-striped table-hover",id:"printMarcado"},k=n((()=>(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"#"),(0,o.Lk)("th",null,"Detalle"),(0,o.Lk)("th",null,"Lugar"),(0,o.Lk)("th",null,"Turno"),(0,o.Lk)("th",null,"Hora M."),(0,o.Lk)("th",null,"Min. R."),(0,o.Lk)("th",null,"Obs.")])],-1))),f=n((()=>(0,o.Lk)("br",null,null,-1))),m=n((()=>(0,o.Lk)("br",null,null,-1))),b=n((()=>(0,o.Lk)("br",null,null,-1))),v=n((()=>(0,o.Lk)("br",null,null,-1))),L=n((()=>(0,o.Lk)("br",null,null,-1))),_=n((()=>(0,o.Lk)("br",null,null,-1))),F=n((()=>(0,o.Lk)("br",null,null,-1))),C=n((()=>(0,o.Lk)("br",null,null,-1))),S={key:0,class:"badge bg-danger"},E={key:1},R=n((()=>(0,o.Lk)("br",null,null,-1))),x={key:2,class:"badge bg-danger"},y={key:3},I=n((()=>(0,o.Lk)("br",null,null,-1))),W={key:4,class:"badge bg-danger"},D={key:5},A=n((()=>(0,o.Lk)("br",null,null,-1))),z={key:6,class:"badge bg-danger"},P={key:7},w=n((()=>(0,o.Lk)("br",null,null,-1))),M=n((()=>(0,o.Lk)("br",null,null,-1))),X=n((()=>(0,o.Lk)("br",null,null,-1))),H=n((()=>(0,o.Lk)("br",null,null,-1))),$=n((()=>(0,o.Lk)("th",null,null,-1))),B=n((()=>(0,o.Lk)("th",null,null,-1))),T=n((()=>(0,o.Lk)("th",null,null,-1))),U=n((()=>(0,o.Lk)("th",null,null,-1))),V=n((()=>(0,o.Lk)("th",null,"Total Retraso",-1))),J=n((()=>(0,o.Lk)("th",null,"min.",-1))),j=n((()=>(0,o.Lk)("th",null,null,-1))),K=n((()=>(0,o.Lk)("th",null,null,-1))),G=n((()=>(0,o.Lk)("th",null,null,-1))),Y=n((()=>(0,o.Lk)("th",null,null,-1))),q=n((()=>(0,o.Lk)("th",null,"Total Salidas Anticipadas",-1))),N=n((()=>(0,o.Lk)("th",null,"min.",-1))),Q=n((()=>(0,o.Lk)("th",null,null,-1))),O=n((()=>(0,o.Lk)("th",null,null,-1))),Z=n((()=>(0,o.Lk)("th",null,null,-1))),ee=n((()=>(0,o.Lk)("th",null,null,-1))),te=n((()=>(0,o.Lk)("th",null,"Total Dias de Descuento",-1))),re=n((()=>(0,o.Lk)("th",null,null,-1))),oe={class:"oculto"};function le(e,t,r,l,s,a){const n=(0,o.g2)("CCol"),le=(0,o.g2)("CIcon"),se=(0,o.g2)("CButton"),ae=(0,o.g2)("CRow"),ie=(0,o.g2)("CCardHeader"),ne=(0,o.g2)("CBadge"),ue=(0,o.g2)("CCardBody"),ce=(0,o.g2)("QrcodeVue"),he=(0,o.g2)("CCardFooter"),de=(0,o.g2)("CCard");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",u,(0,i.v_)(r.reporte.cif),1),(0,o.bF)(ae,null,{default:(0,o.k6)((()=>[(0,o.bF)(n,{lg:12},{default:(0,o.k6)((()=>[(0,o.bF)(de,null,{default:(0,o.k6)((()=>[(0,o.bF)(ie,{class:"headercolor"},{default:(0,o.k6)((()=>[(0,o.bF)(ae,null,{default:(0,o.k6)((()=>[(0,o.bF)(n,{lg:8,class:"text-center"},{default:(0,o.k6)((()=>[(0,o.eW)("Reporte de Asistencia del mes de "+(0,i.v_)(s.mes)+" de "+(0,i.v_)(r.reporte.gestion),1)])),_:1}),(0,o.bF)(n,{lg:4,class:"text-end"},{default:(0,o.k6)((()=>[(0,o.bF)(se,{onClick:t[0]||(t[0]=e=>a.pdf()),color:"success",class:"font",size:"sm"},{default:(0,o.k6)((()=>[(0,o.bF)(le,{icon:"cil-cloud-download",class:"me-2"}),(0,o.eW)("Descargar PDF")])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(ue,null,{default:(0,o.k6)((()=>[(0,o.bF)(ae,null,{default:(0,o.k6)((()=>[(0,o.bF)(n,{lg:12,class:"table-responsive"},{default:(0,o.k6)((()=>[(0,o.Lk)("table",c,[h,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.reporte.listaPerfil,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,[(0,o.bF)(ne,{color:"light"},{default:(0,o.k6)((()=>[(0,o.eW)("ID-B : "+(0,i.v_)(e.id),1)])),_:2},1024)]),(0,o.Lk)("td",null,[(0,o.bF)(ne,{color:"light"},{default:(0,o.k6)((()=>[(0,o.eW)("User ID : "+(0,i.v_)(e.user_id),1)])),_:2},1024)]),(0,o.Lk)("td",null,[(0,o.bF)(ne,{color:"light"},{default:(0,o.k6)((()=>[(0,o.eW)("Nombre : "+(0,i.v_)(e.nombre),1)])),_:2},1024)]),(0,o.Lk)("td",null,[(0,o.bF)(ne,{color:"light"},{default:(0,o.k6)((()=>[(0,o.eW)("Lugar : "+(0,i.v_)(e.detalle),1)])),_:2},1024)]),(0,o.Lk)("td",null,[(0,o.bF)(ne,{color:"light"},{default:(0,o.k6)((()=>[(0,o.eW)("Sigla : "+(0,i.v_)(e.lugar),1)])),_:2},1024)])])))),128))])])),_:1})])),_:1}),(0,o.bF)(ae,null,{default:(0,o.k6)((()=>[(0,o.bF)(n,{lg:12,class:"table-responsive"},{default:(0,o.k6)((()=>[(0,o.Lk)("table",d,[p,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.reporte.listaHorario,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.horario_id},[(0,o.Lk)("td",null,[(0,o.bF)(ne,{color:"light"},{default:(0,o.k6)((()=>[(0,o.eW)("ID Horario : "+(0,i.v_)(e.horario_id),1)])),_:2},1024)]),(0,o.Lk)("td",null,[(0,o.bF)(ne,{color:"light"},{default:(0,o.k6)((()=>[(0,o.eW)("Valido del : "+(0,i.v_)(e.fecha),1)])),_:2},1024)]),(0,o.Lk)("td",null,[(0,o.bF)(ne,{color:"light"},{default:(0,o.k6)((()=>[(0,o.eW)("Hasta "+(0,i.v_)(e.valido),1)])),_:2},1024)])])))),128))])])),_:1})])),_:1}),(0,o.bF)(ae,null,{default:(0,o.k6)((()=>[(0,o.bF)(n,{lg:12,class:"table-responsive"},{default:(0,o.k6)((()=>[(0,o.Lk)("table",g,[k,(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.listaReporte,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,(0,i.v_)(e.id),1),(0,o.Lk)("td",null,[(0,o.eW)((0,i.v_)(e.dia)+" "+(0,i.v_)(e.day),1),f,(0,o.bF)(ne,{color:"dark"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.fecha),1)])),_:2},1024),m]),(0,o.Lk)("td",null,[(0,o.bF)(ne,{color:"success"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.lugar[0]),1)])),_:2},1024),b,(0,o.bF)(ne,{color:"success"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.lugar[1]),1)])),_:2},1024),v,(0,o.bF)(ne,{color:"success"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.lugar[2]),1)])),_:2},1024),L,(0,o.bF)(ne,{color:"success"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.lugar[3]),1)])),_:2},1024)]),(0,o.Lk)("td",null,[(0,o.bF)(ne,{color:"success"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.turno[0]),1)])),_:2},1024),_,(0,o.eW)((0,i.v_)(e.turno[1]),1),F,(0,o.eW)((0,i.v_)(e.turno[2]),1),C,(0,o.eW)((0,i.v_)(e.turno[3]),1)]),(0,o.Lk)("td",null,["Sin Marcar"==e.hora[0]?((0,o.uX)(),(0,o.CE)("span",S,(0,i.v_)(e.hora[0]),1)):((0,o.uX)(),(0,o.CE)("span",E,(0,i.v_)(e.hora[0]),1)),R,"Sin Marcar"==e.hora[1]?((0,o.uX)(),(0,o.CE)("span",x,(0,i.v_)(e.hora[1]),1)):((0,o.uX)(),(0,o.CE)("span",y,(0,i.v_)(e.hora[1]),1)),I,"Sin Marcar"==e.hora[2]?((0,o.uX)(),(0,o.CE)("span",W,(0,i.v_)(e.hora[2]),1)):((0,o.uX)(),(0,o.CE)("span",D,(0,i.v_)(e.hora[2]),1)),A,"Sin Marcar"==e.hora[3]?((0,o.uX)(),(0,o.CE)("span",z,(0,i.v_)(e.hora[3]),1)):((0,o.uX)(),(0,o.CE)("span",P,(0,i.v_)(e.hora[3]),1))]),(0,o.Lk)("td",null,[(0,o.eW)((0,i.v_)(e.retraso[0]),1),w,(0,o.eW)((0,i.v_)(e.retraso[1]),1),M,(0,o.eW)((0,i.v_)(e.retraso[2]),1),X,(0,o.eW)((0,i.v_)(e.retraso[3]),1)]),(0,o.Lk)("td",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.obsDtoReporte,(e=>((0,o.uX)(),(0,o.CE)("div",{class:"obserbaciones",key:e.id},[(0,o.bF)(ne,{color:"warning"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.uidobs)+" "+(0,i.v_)(e.tipo)+" "+(0,i.v_)(e.hora),1)])),_:2},1024),H])))),128))])])))),128))]),(0,o.Lk)("tfoot",null,[(0,o.Lk)("tr",null,[$,B,T,U,V,(0,o.Lk)("th",null,[(0,o.Lk)("h2",null,(0,i.v_)(s.totalretraso),1)]),J]),(0,o.Lk)("tr",null,[j,K,G,Y,q,(0,o.Lk)("th",null,[(0,o.Lk)("h2",null,(0,i.v_)(s.totalanticipado),1)]),N]),(0,o.Lk)("tr",null,[Q,O,Z,ee,te,(0,o.Lk)("th",null,[(0,o.Lk)("h2",null,(0,i.v_)(s.totalsin),1)]),re])])])])),_:1})])),_:1})])),_:1}),(0,o.bF)(he,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",oe,[(0,o.bF)(ce,{value:s.sms,size:s.size,level:"H",ref:"qr"},null,8,["value","size"])])])),_:1})])),_:1})])),_:1})])),_:1})],64)}var se=r(9877),ae=r(7590),ie=r(7160),ne=r(1749),ue=r(5839),ce=r.n(ue),he={name:"ComponenteReporteVue",props:["reporte","uri"],components:{QrcodeVue:se.A},data(){return{sccService:null,uploadService:null,listaReporte:[],getPB:!0,totalretraso:0,totalanticipado:0,totalsin:0,mes:"",sms:"",size:300}},created(){this.sccService=new ae.A,this.uploadService=new ie.A},updated(){this.reporte.cif>0&&this.getPB&&(this.getMes(),this.getReporteMes(),this.getPB=!1)},methods:{async getReporteMes(){await this.sccService.getReporteMes(this.reporte).then((e=>{this.listaReporte=e.data,this.sumaRetraso(),console.log(this.listaReporte)})).catch((e=>{console.log(e)}))},sumaRetraso(){let e=0,t=0,r=0;this.listaReporte.forEach((o=>{const l=o.retraso.some((e=>e>0)),s=o.hora.includes("Sin Marcar");(l||s)&&(r+=1),o.retraso.forEach(((r,o)=>{o%2===0?e+=parseInt(r,10):t+=parseInt(r,10)}))})),this.totalretraso=e,this.totalanticipado=t,this.totalsin=r;const o="/libreReporte"+this.uri;this.sms="Cif:"+this.reporte.cif+" TR: "+this.totalretraso+"min TA: "+this.totalanticipado+"min https://svfhce.umsa.bo/#"+o},getMes(){1==this.reporte.mes&&(this.mes="Enero"),2==this.reporte.mes&&(this.mes="Febrero"),3==this.reporte.mes&&(this.mes="Marzo"),4==this.reporte.mes&&(this.mes="Abril"),5==this.reporte.mes&&(this.mes="Mayo"),6==this.reporte.mes&&(this.mes="Junio"),7==this.reporte.mes&&(this.mes="Julio"),8==this.reporte.mes&&(this.mes="Agosto"),9==this.reporte.mes&&(this.mes="Septiembre"),10==this.reporte.mes&&(this.mes="Octubre"),11==this.reporte.mes&&(this.mes="Noviembre"),12==this.reporte.mes&&(this.mes="Diciembre")},pdf(){var e=new Image;const t=new Date,r=new ne["default"]("p","mm","letter"),o=this.$refs.qr.$el,l=o.toDataURL("image/jpeg",.8);r.setFontSize(10),e.src="https://fhcevirtual.umsa.bo/egovf-img/imagenes/logoticjpg.jpg",r.addImage(e,"JPEG",43,14,15,10),e.src="https://fhcevirtual.umsa.bo/egovf-img/imagenes/logofhce.jpg",r.addImage(e,"JPEG",215/7.8,14,15,10),e.src="https://fhcevirtual.umsa.bo/egovf-img/imagenes/logoumsa.jpg",r.addImage(e,"JPEG",21.5,12,6,12),r.addImage(l,"JPEG",160,12,40,40),r.setFontSize(12),r.setFont(void 0,"bold"),r.text("Universidad Mayor de San Andrés",107.5,18,{align:"center"}),r.setFontSize(10),r.setFont(void 0,"normal"),r.text("Facultad de Humanidades y Ciencias de la Educación",107.5,23,{align:"center"}),r.setFontSize(8),r.text("Unidad de Tecnologías de la Información y la Comunicación  UMSA-FHCE",107.5,28,{align:"center"}),r.setFontSize(15),r.text("Datos de Personales :",20,40),r.setFontSize(10),e.src=this.reporte.persona.foto,r.addImage(e,"JPEG",20,47,30,30),r.text("CIF : "+this.reporte.cif,52,50),r.text("Nombre : "+this.reporte.persona.nombre,52,55),r.text("Apellidos : "+this.reporte.persona.paterno+" "+this.reporte.persona.materno,52,60),r.text("Celular : "+this.reporte.persona.celular,52,65),r.text("Unidad : "+this.reporte.sigla,52,70),r.text("ID app : "+this.reporte.persona.id,120,50),r.text("C.I. : "+this.reporte.persona.ci,120,55),r.text("Correo : "+this.reporte.persona.correo,120,60),r.setFontSize(15),r.text("Total Dias de Descuento : "+this.totalsin,120,70),r.setFontSize(10),r.text("Retraso  : "+this.totalretraso+" min.",120,78),r.text("Salida Anticipada : "+this.totalanticipado+" min.",120,82),r.setFontSize(6),r.text("Fecha de Imprecion : "+t,120,86),r.setFontSize(10);var s=95;20903198600!=this.reporte.cif?(r.text("Lic. Jaime A. Montecinos Marquez",53.75,s+25,{align:"center"}),r.text("Responsable Unidad TIC.",53.75,s+30,{align:"center"}),r.text("Vo. Bo.",162,s+25,{align:"center"}),r.text("Inmediato Superior",162,s+30,{align:"center"})):(r.text("Vo. Bo.",107.5,s+25,{align:"center"}),r.text("Inmediato Superior",107.5,s+30,{align:"center"})),s+=45,ce()(r,{theme:"striped",startY:s,margin:{left:20},styles:{fontSize:8},html:"#printDatos",showFoot:"lastPage"}),s=r.lastAutoTable.finalY,s+=10,ce()(r,{startY:s,margin:{left:20},styles:{fontSize:8},html:"#printHorario",showFoot:"lastPage"}),s=r.lastAutoTable.finalY,r.setFontSize(15),r.text("Reporte de Asistencia del mes de "+this.mes+" del "+this.reporte.gestion,107.5,s+10,{align:"center"}),ce()(r,{startY:s+15,margin:{left:15},styles:{fontSize:7.5},html:"#printMarcado",showFoot:"lastPage"}),r.save(this.reporte.cif+this.mes+"reporte.pdf")}}},de=r(1241);const pe=(0,de.A)(he,[["render",le],["__scopeId","data-v-c666e7fe"]]);var ge=pe,ke=r(7950),fe={name:"ReporteView",components:{ComponenteDatosPersonalesVue:a.A,ComponenteReporteVue:ge},data(){return{titulo:"Reporte de Asistencia",sccService:null,egovfService:null,uri:"",cifCiudadano:"",usuario:{token:"",cif:"",correo:"",celular:"",pass:"",unidad:"",sigla:""},reporte:{cif:0,sigla:"",gestion:0,mes:0,di:0,df:0,listaPerfil:[],listaHorario:[],persona:{id:null,ci:"",nombre:"",paterno:"",materno:"",celular:"",correo:"",foto:""}},egovf:{idPersona:0,nombre:"",paterno:"",materno:"",fecha:"",sexo:0,idUsuario:0,cif:0,matricula:0,ci:"",ci_com:0,complemento:"",correo:"",celular:"",pass:"",unidad:"",dependiente:"",sigla:"",foto:""}}},mounted(){this.uri=this.$route.params.uri,this.cifCiudadano=this.uri.substring(0,11),this.reporte.cif=this.uri.substring(0,11),this.reporte.gestion=this.uri.substring(12,16),this.reporte.mes=this.uri.substring(17,19),this.reporte.di=this.uri.substring(20,22),this.reporte.df=this.uri.slice(23),this.reporte.uri=this.uri,this.getDatos(),this.getEgovf(),this.getReporteBiometrico()},beforeCreate(){null==this.$cookies.get("cif")&&this.$router.push("/")},created(){this.sccService=new ae.A,this.egovfService=new ke.A},methods:{getDatos(){null!=this.$cookies.get("cif")&&(this.usuario.token=this.$cookies.get("token"),this.usuario.cif=this.$cookies.get("cif"),this.usuario.correo=this.$cookies.get("correo"),this.usuario.celular=this.$cookies.get("celular"),this.usuario.pass=this.$cookies.get("pass"),this.usuario.unidad=this.$cookies.get("unidad"),this.usuario.sigla=this.$cookies.get("sigla"))},async getEgovf(){this.egovfService.headersUsuario(this.usuario.token),await this.egovfService.getEgovf(this.cifCiudadano).then((e=>{this.egovf=e.data})),this.reporte.sigla=this.egovf.sigla,this.reporte.persona.id=this.egovf.idPersona,this.reporte.persona.ci=this.egovf.ci,this.reporte.persona.nombre=this.egovf.nombre,this.reporte.persona.paterno=this.egovf.paterno,this.reporte.persona.materno=this.egovf.materno,this.reporte.persona.celular=this.egovf.celular,this.reporte.persona.correo=this.egovf.correo,this.reporte.persona.foto=this.egovf.foto},async getReporteBiometrico(){await this.sccService.getPerfil(this.reporte.cif).then((e=>{this.reporte.listaPerfil=e.data})),this.getListaHorario()},async getListaHorario(){await this.sccService.getListaHorario(this.cifCiudadano,this.reporte.gestion).then((e=>{this.reporte.listaHorario=e.data}))}}};const me=(0,de.A)(fe,[["render",s]]);var be=me}}]);
//# sourceMappingURL=67.4fcc0d84.js.map