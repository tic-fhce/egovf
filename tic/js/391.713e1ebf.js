"use strict";(self["webpackChunkegovf"]=self["webpackChunkegovf"]||[]).push([[391],{7848:function(e,t,r){r.r(t),r.d(t,{default:function(){return ie}});var s=r(6768);const o=(0,s.Lk)("br",null,null,-1);function a(e,t,r,a,i,l){const n=(0,s.g2)("ComponenteDatosPersonalesVue"),u=(0,s.g2)("ComponenteReporteVue");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(n,{cifCiudadano:i.cifCiudadano,egovfp:i.egovf},null,8,["cifCiudadano","egovfp"]),o,(0,s.bF)(u,{reporte:i.reporte,uri:i.uri},null,8,["reporte","uri"])],64)}r(4114);var i=r(2453),l=r(4232);const n=e=>((0,s.Qi)("data-v-5071fdc9"),e=e(),(0,s.jt)(),e),u={class:"oculto"},c={class:"align-items-center"},d={class:"mb-0 fs-6 text-white"},h={class:"table table-striped table-hover",id:"printDatos"},p=n((()=>(0,s.Lk)("tr",null,[(0,s.Lk)("td",{colspan:"5",class:"text-center"},[(0,s.Lk)("h4",null,"Datos de Usuario Registrado en Biometricos")])],-1))),g={class:"table table-striped table-hover",id:"printHorario"},f=n((()=>(0,s.Lk)("tr",null,[(0,s.Lk)("td",{colspan:"4",class:"text-center"},[(0,s.Lk)("h4",null,"Horarios del Usuario")])],-1))),k={class:"table table-striped table-hover",id:"printMarcado"},b=n((()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"#"),(0,s.Lk)("th",null,"Detalle"),(0,s.Lk)("th",null,"Lugar"),(0,s.Lk)("th",null,"Turno"),(0,s.Lk)("th",null,"Hora M."),(0,s.Lk)("th",null,"Min. R."),(0,s.Lk)("th",null,"Obs.")])],-1))),m=n((()=>(0,s.Lk)("br",null,null,-1))),v=n((()=>(0,s.Lk)("br",null,null,-1))),_=n((()=>(0,s.Lk)("br",null,null,-1))),F=n((()=>(0,s.Lk)("br",null,null,-1))),L=n((()=>(0,s.Lk)("br",null,null,-1))),C=n((()=>(0,s.Lk)("br",null,null,-1))),S=n((()=>(0,s.Lk)("br",null,null,-1))),E=n((()=>(0,s.Lk)("br",null,null,-1))),x={key:0,class:"badge bg-danger"},R={key:1},y=n((()=>(0,s.Lk)("br",null,null,-1))),w={key:2,class:"badge bg-danger"},I={key:3},W=n((()=>(0,s.Lk)("br",null,null,-1))),M={key:4,class:"badge bg-danger"},z={key:5},A=n((()=>(0,s.Lk)("br",null,null,-1))),D={key:6,class:"badge bg-danger"},P={key:7},X=n((()=>(0,s.Lk)("br",null,null,-1))),H=n((()=>(0,s.Lk)("br",null,null,-1))),$=n((()=>(0,s.Lk)("br",null,null,-1))),B=n((()=>(0,s.Lk)("br",null,null,-1))),U=n((()=>(0,s.Lk)("th",{colspan:"5"},"Total Minutos de Retraso",-1))),V=n((()=>(0,s.Lk)("th",null,"min.",-1))),T=n((()=>(0,s.Lk)("th",{colspan:"5"},"Total Minutos de Salidas Anticipadas",-1))),J=n((()=>(0,s.Lk)("th",null,"min.",-1))),j={class:"oculto"};function K(e,t,r,o,a,i){const n=(0,s.g2)("CIcon"),K=(0,s.g2)("CCol"),G=(0,s.g2)("CDropdownToggle"),Y=(0,s.g2)("CButton"),q=(0,s.g2)("CDropdownItem"),N=(0,s.g2)("CDropdownMenu"),O=(0,s.g2)("CDropdown"),Q=(0,s.g2)("CRow"),Z=(0,s.g2)("CCardHeader"),ee=(0,s.g2)("CBadge"),te=(0,s.g2)("CCardBody"),re=(0,s.g2)("QrcodeVue"),se=(0,s.g2)("CCardFooter"),oe=(0,s.g2)("CCard");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",u,(0,l.v_)(r.reporte.cif),1),(0,s.bF)(Q,null,{default:(0,s.k6)((()=>[(0,s.bF)(K,{lg:12},{default:(0,s.k6)((()=>[(0,s.bF)(oe,null,{default:(0,s.k6)((()=>[(0,s.bF)(Z,{class:"headercolor justify-content-between align-items-center"},{default:(0,s.k6)((()=>[(0,s.bF)(Q,null,{default:(0,s.k6)((()=>[(0,s.bF)(K,{lg:6},{default:(0,s.k6)((()=>[(0,s.Lk)("div",c,[(0,s.bF)(n,{icon:"cil-list",size:"lg",class:"me-2 text-light"}),(0,s.Lk)("label",d,"Reporte de Asistencia del mes de "+(0,l.v_)(a.mes)+" de "+(0,l.v_)(r.reporte.gestion),1)])])),_:1}),(0,s.bF)(K,{lg:6,class:"text-end"},{default:(0,s.k6)((()=>[(0,s.bF)(O,{variant:"btn-group"},{default:(0,s.k6)((()=>[(0,s.bF)(G,{color:"dark",class:"font border-0 shadow-sm",size:"sm"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{icon:"cil-menu",class:"me-2 text-success"}),(0,s.eW)("Opciones")])),_:1}),(0,s.bF)(N,null,{default:(0,s.k6)((()=>[(0,s.bF)(q,null,{default:(0,s.k6)((()=>[(0,s.bF)(Y,{onClick:t[0]||(t[0]=e=>i.pdf()),size:"sm"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{icon:"cil-cloud-download",class:"me-2"}),(0,s.eW)("Descargar Reporte")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.bF)(te,null,{default:(0,s.k6)((()=>[(0,s.bF)(Q,null,{default:(0,s.k6)((()=>[(0,s.bF)(K,{lg:12,class:"table-responsive"},{default:(0,s.k6)((()=>[(0,s.Lk)("table",h,[p,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.reporte.listaPerfil,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,[(0,s.bF)(ee,{color:"light"},{default:(0,s.k6)((()=>[(0,s.eW)("ID-B : "+(0,l.v_)(e.id),1)])),_:2},1024)]),(0,s.Lk)("td",null,[(0,s.bF)(ee,{color:"light"},{default:(0,s.k6)((()=>[(0,s.eW)("User ID : "+(0,l.v_)(e.user_id),1)])),_:2},1024)]),(0,s.Lk)("td",null,[(0,s.bF)(ee,{color:"light"},{default:(0,s.k6)((()=>[(0,s.eW)("Nombre : "+(0,l.v_)(e.nombre),1)])),_:2},1024)]),(0,s.Lk)("td",null,[(0,s.bF)(ee,{color:"light"},{default:(0,s.k6)((()=>[(0,s.eW)("Lugar : "+(0,l.v_)(e.detalle),1)])),_:2},1024)]),(0,s.Lk)("td",null,[(0,s.bF)(ee,{color:"light"},{default:(0,s.k6)((()=>[(0,s.eW)("Sigla : "+(0,l.v_)(e.lugar),1)])),_:2},1024)])])))),128))])])),_:1})])),_:1}),(0,s.bF)(Q,null,{default:(0,s.k6)((()=>[(0,s.bF)(K,{lg:12,class:"table-responsive"},{default:(0,s.k6)((()=>[(0,s.Lk)("table",g,[f,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.reporte.listaHorario,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.horario_id},[(0,s.Lk)("td",null,[(0,s.bF)(ee,{color:"light"},{default:(0,s.k6)((()=>[(0,s.eW)("ID Horario : "+(0,l.v_)(e.horario_id),1)])),_:2},1024)]),(0,s.Lk)("td",null,[(0,s.bF)(ee,{color:"light"},{default:(0,s.k6)((()=>[(0,s.eW)("Valido del : "+(0,l.v_)(e.fecha),1)])),_:2},1024)]),(0,s.Lk)("td",null,[(0,s.bF)(ee,{color:"light"},{default:(0,s.k6)((()=>[(0,s.eW)("Hasta "+(0,l.v_)(e.valido),1)])),_:2},1024)])])))),128))])])),_:1})])),_:1}),(0,s.bF)(Q,null,{default:(0,s.k6)((()=>[(0,s.bF)(K,{lg:12,class:"table-responsive"},{default:(0,s.k6)((()=>[(0,s.Lk)("table",k,[b,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.listaReporte,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,(0,l.v_)(e.id),1),(0,s.Lk)("td",null,[(0,s.eW)((0,l.v_)(e.dia)+" "+(0,l.v_)(e.day),1),m,(0,s.bF)(ee,{color:"dark"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.fecha),1)])),_:2},1024),v]),(0,s.Lk)("td",null,[(0,s.bF)(ee,{color:"success"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.lugar[0]),1)])),_:2},1024),_,(0,s.bF)(ee,{color:"success"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.lugar[1]),1)])),_:2},1024),F,(0,s.bF)(ee,{color:"success"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.lugar[2]),1)])),_:2},1024),L,(0,s.bF)(ee,{color:"success"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.lugar[3]),1)])),_:2},1024)]),(0,s.Lk)("td",null,[(0,s.bF)(ee,{color:"success"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.turno[0]),1)])),_:2},1024),C,(0,s.eW)((0,l.v_)(e.turno[1]),1),S,(0,s.eW)((0,l.v_)(e.turno[2]),1),E,(0,s.eW)((0,l.v_)(e.turno[3]),1)]),(0,s.Lk)("td",null,["Sin Marcar"==e.hora[0]?((0,s.uX)(),(0,s.CE)("span",x,(0,l.v_)(e.hora[0]),1)):((0,s.uX)(),(0,s.CE)("span",R,(0,l.v_)(e.hora[0]),1)),y,"Sin Marcar"==e.hora[1]?((0,s.uX)(),(0,s.CE)("span",w,(0,l.v_)(e.hora[1]),1)):((0,s.uX)(),(0,s.CE)("span",I,(0,l.v_)(e.hora[1]),1)),W,"Sin Marcar"==e.hora[2]?((0,s.uX)(),(0,s.CE)("span",M,(0,l.v_)(e.hora[2]),1)):((0,s.uX)(),(0,s.CE)("span",z,(0,l.v_)(e.hora[2]),1)),A,"Sin Marcar"==e.hora[3]?((0,s.uX)(),(0,s.CE)("span",D,(0,l.v_)(e.hora[3]),1)):((0,s.uX)(),(0,s.CE)("span",P,(0,l.v_)(e.hora[3]),1))]),(0,s.Lk)("td",null,[(0,s.bF)(ee,{color:e.retraso[0]>0?"danger":"success",class:"retraso-badge"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.retraso[0]),1)])),_:2},1032,["color"]),X,(0,s.bF)(ee,{color:e.retraso[1]>0?"danger":"success",class:"retraso-badge"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.retraso[1]),1)])),_:2},1032,["color"]),H,(0,s.bF)(ee,{color:e.retraso[2]>0?"danger":"success",class:"retraso-badge"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.retraso[2]),1)])),_:2},1032,["color"]),$,(0,s.bF)(ee,{color:e.retraso[3]>0?"danger":"success",class:"retraso-badge"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.retraso[3]),1)])),_:2},1032,["color"])]),(0,s.Lk)("td",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.obsDtoReporte,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"obserbaciones",key:e.id},[(0,s.bF)(ee,{color:"info"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(e.uidobs)+" | "+(0,l.v_)(e.tipo),1)])),_:2},1024),B])))),128))])])))),128))]),(0,s.Lk)("tfoot",null,[(0,s.Lk)("tr",null,[U,(0,s.Lk)("th",null,[(0,s.Lk)("h2",null,(0,l.v_)(a.totalretraso),1)]),V]),(0,s.Lk)("tr",null,[T,(0,s.Lk)("th",null,[(0,s.Lk)("h2",null,(0,l.v_)(a.totalanticipado),1)]),J])])])])),_:1})])),_:1})])),_:1}),(0,s.bF)(se,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",j,[(0,s.bF)(re,{value:a.sms,size:a.size,level:"H",ref:"qr"},null,8,["value","size"])])])),_:1})])),_:1})])),_:1})])),_:1})],64)}var G=r(9877),Y=r(7590),q=r(7160),N=r(1749),O=r(5839),Q=r.n(O),Z={name:"ComponenteReporteVue",props:["reporte","uri"],components:{QrcodeVue:G.A},data(){return{sccService:null,uploadService:null,listaReporte:[],getPB:!0,totalretraso:0,totalanticipado:0,totalsin:0,mes:"",sms:"",size:300}},created(){this.sccService=new Y.A,this.uploadService=new q.A},updated(){this.reporte.cif>0&&this.getPB&&(this.getMes(),this.getReporteMes(),this.getPB=!1)},methods:{async getReporteMes(){await this.sccService.getReporteMes(this.reporte).then((e=>{this.listaReporte=e.data,this.sumaRetraso()})).catch((e=>{console.log(e)}))},sumaRetraso(){let e=0,t=0,r=0;this.listaReporte.forEach((s=>{const o=s.retraso.some((e=>e>0)),a=s.hora.includes("Sin Marcar");(o||a)&&(r+=1),s.retraso.forEach(((r,s)=>{s%2===0?e+=parseInt(r,10):t+=parseInt(r,10)}))})),this.totalretraso=e,this.totalanticipado=t,this.totalsin=r;const s="/libreReporte"+this.uri;this.sms="Cif:"+this.reporte.cif+" TR: "+this.totalretraso+"min TA: "+this.totalanticipado+"min https://svfhce.umsa.bo"+s},getMes(){1==this.reporte.mes&&(this.mes="Enero"),2==this.reporte.mes&&(this.mes="Febrero"),3==this.reporte.mes&&(this.mes="Marzo"),4==this.reporte.mes&&(this.mes="Abril"),5==this.reporte.mes&&(this.mes="Mayo"),6==this.reporte.mes&&(this.mes="Junio"),7==this.reporte.mes&&(this.mes="Julio"),8==this.reporte.mes&&(this.mes="Agosto"),9==this.reporte.mes&&(this.mes="Septiembre"),10==this.reporte.mes&&(this.mes="Octubre"),11==this.reporte.mes&&(this.mes="Noviembre"),12==this.reporte.mes&&(this.mes="Diciembre")},pdf(){var e=new Image;const t=new Date,r=new N["default"]("p","mm","letter"),s=this.$refs.qr.$el,o=s.toDataURL("image/jpeg",.8);r.setFontSize(10),e.src="https://fhcevirtual.umsa.bo/egovf-img/imagenes/logoticjpg.jpg",r.addImage(e,"JPEG",43,14,15,10),e.src="https://fhcevirtual.umsa.bo/egovf-img/imagenes/logofhce.jpg",r.addImage(e,"JPEG",215/7.8,14,15,10),e.src="https://fhcevirtual.umsa.bo/egovf-img/imagenes/logoumsa.jpg",r.addImage(e,"JPEG",21.5,12,6,12),r.addImage(o,"JPEG",160,12,40,40),r.setFontSize(12),r.setFont(void 0,"bold"),r.text("Universidad Mayor de San Andrés",107.5,18,{align:"center"}),r.setFontSize(10),r.setFont(void 0,"normal"),r.text("Facultad de Humanidades y Ciencias de la Educación",107.5,23,{align:"center"}),r.setFontSize(8),r.text("Unidad de Tecnologías de la Información y la Comunicación  UMSA-FHCE",107.5,28,{align:"center"}),r.setFontSize(15),r.text("Datos de Personales :",20,40),r.setFontSize(10),e.src="https://fhcevirtual.umsa.bo/egovf-img/imagenes/200/"+this.reporte.persona.foto,r.addImage(e,"JPEG",20,47,30,30),r.text("CIF : "+this.reporte.cif,52,50),r.text("Nombre : "+this.reporte.persona.nombre,52,55),r.text("Apellidos : "+this.reporte.persona.paterno+" "+this.reporte.persona.materno,52,60),r.text("Celular : "+this.reporte.persona.celular,52,65),r.text("Unidad : "+this.reporte.sigla,52,70),r.text("ID app : "+this.reporte.persona.id,120,50),r.text("C.I. : "+this.reporte.persona.ci,120,55),r.text("Correo : "+this.reporte.persona.correo,120,60),r.setFontSize(15),r.text("Retraso  : "+this.totalretraso+" min.",120,70),r.text("Salida Anticipada : "+this.totalanticipado+" min.",120,80),r.setFontSize(6),r.text("Fecha de Imprecion : "+t,120,86),r.setFontSize(10);var a=95;20903198600!=this.reporte.cif?(r.text("Lic. Jaime A. Montecinos Marquez",53.75,a+25,{align:"center"}),r.text("Responsable Unidad TIC.",53.75,a+30,{align:"center"}),r.text("Vo. Bo.",162,a+25,{align:"center"}),r.text("Inmediato Superior",162,a+30,{align:"center"})):(r.text("Vo. Bo.",107.5,a+25,{align:"center"}),r.text("Inmediato Superior",107.5,a+30,{align:"center"})),a+=45,Q()(r,{theme:"striped",startY:a,margin:{left:20},styles:{fontSize:8},html:"#printDatos",showFoot:"lastPage"}),a=r.lastAutoTable.finalY,a+=10,Q()(r,{startY:a,margin:{left:20},styles:{fontSize:8},html:"#printHorario",showFoot:"lastPage"}),a=r.lastAutoTable.finalY,r.setFontSize(15),r.text("Reporte de Asistencia del mes de "+this.mes+" del "+this.reporte.gestion,107.5,a+10,{align:"center"}),Q()(r,{startY:a+15,margin:{left:15},styles:{fontSize:7.5},html:"#printMarcado",showFoot:"lastPage"}),r.save(this.reporte.cif+this.mes+"reporte.pdf")}}},ee=r(1241);const te=(0,ee.A)(Z,[["render",K],["__scopeId","data-v-5071fdc9"]]);var re=te,se=r(7950),oe={name:"ReporteView",components:{ComponenteDatosPersonalesVue:i.A,ComponenteReporteVue:re},data(){return{titulo:"Reporte de Asistencia",sccService:null,egovfService:null,uri:"",cifCiudadano:"",usuario:{token:"",cif:"",correo:"",celular:"",pass:"",unidad:"",sigla:""},reporte:{cif:0,sigla:"",gestion:0,mes:0,di:0,df:0,listaPerfil:[],listaHorario:[],persona:{id:null,ci:"",nombre:"",paterno:"",materno:"",celular:"",correo:"",foto:""}},egovf:{idPersona:0,nombre:"",paterno:"",materno:"",fecha:"",sexo:0,idUsuario:0,cif:0,matricula:0,ci:"",ci_com:0,complemento:"",correo:"",celular:"",pass:"",unidad:"",dependiente:"",sigla:"",foto:""}}},mounted(){this.uri=this.$route.params.uri,this.cifCiudadano=this.uri.substring(0,11),this.reporte.cif=this.uri.substring(0,11),this.reporte.gestion=this.uri.substring(12,16),this.reporte.mes=this.uri.substring(17,19),this.reporte.di=this.uri.substring(20,22),this.reporte.df=this.uri.slice(23),this.reporte.uri=this.uri,this.getDatos(),this.getEgovf(),this.getReporteBiometrico()},beforeCreate(){null==this.$cookies.get("cif")&&this.$router.push("/")},created(){this.sccService=new Y.A,this.egovfService=new se.A},methods:{getDatos(){null!=this.$cookies.get("cif")&&(this.usuario.token=this.$cookies.get("token"),this.usuario.cif=this.$cookies.get("cif"),this.usuario.correo=this.$cookies.get("correo"),this.usuario.celular=this.$cookies.get("celular"),this.usuario.pass=this.$cookies.get("pass"),this.usuario.unidad=this.$cookies.get("unidad"),this.usuario.sigla=this.$cookies.get("sigla"))},async getEgovf(){this.egovfService.headersUsuario(this.usuario.token),await this.egovfService.getEgovf(this.cifCiudadano).then((e=>{this.egovf=e.data})),this.reporte.sigla=this.egovf.sigla,this.reporte.persona.id=this.egovf.idPersona,this.reporte.persona.ci=this.egovf.ci,this.reporte.persona.nombre=this.egovf.nombre,this.reporte.persona.paterno=this.egovf.paterno,this.reporte.persona.materno=this.egovf.materno,this.reporte.persona.celular=this.egovf.celular,this.reporte.persona.correo=this.egovf.correo,this.reporte.persona.foto=this.egovf.foto},async getReporteBiometrico(){await this.sccService.getPerfil(this.reporte.cif).then((e=>{this.reporte.listaPerfil=e.data})),this.getListaHorario()},async getListaHorario(){await this.sccService.getListaHorario(this.cifCiudadano,this.reporte.gestion).then((e=>{this.reporte.listaHorario=e.data}))}}};const ae=(0,ee.A)(oe,[["render",a]]);var ie=ae}}]);
//# sourceMappingURL=391.713e1ebf.js.map